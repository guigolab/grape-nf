nextflow_process {

    name "Test Process mergeBam"
    script "modules/mergeBam/samtools/main.nf"
    process "mergeBam"

    tag "module"

    test("Should merge BAM files using samtools") {

        when {
            params {
                maxMismatches = 4
                maxMultimaps = 10
            }
            process {
                """
                input[0] = Channel.from([
                    [ "sample2", [ "test2", "test3" ], file("${baseDir}/data/test*/*toGenome_sorted.bam"), "bam", "GenomeAlignments", true]
                ])
                """
            }
        }

        then {
            assert process.success
            assert snapshot(process.out).match()
        }

    }

}
